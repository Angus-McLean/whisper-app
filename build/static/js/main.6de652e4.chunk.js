(this["webpackJsonpwhisper-app"]=this["webpackJsonpwhisper-app"]||[]).push([[0],{23:function(e,t,a){e.exports=a(40)},28:function(e,t,a){},29:function(e,t,a){},39:function(e,t,a){},40:function(e,t,a){"use strict";a.r(t);var n=a(1),i=a.n(n),r=a(18),o=a.n(r),s=(a(28),a(4)),c=a(5),l=a(12),m=a(7),d=a(6),u=(a(29),a(13)),p=a.n(u),g=a(14),v=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).joinMeeting=function(){var e=Object(g.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log("LandingPage.joinMeeting",t),n.props.goToMeeting({meetingId:document.getElementById("meetingField").value,userId:document.getElementById("userField").value});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.props=e,n}return Object(c.a)(a,[{key:"render",value:function(){return i.a.createElement("div",{className:"landing section"},i.a.createElement("div",{className:"landing text-block-8"},"Join Whisper Meeting"),i.a.createElement("div",{className:"landing text-block-9"},"Video conferencing like they're right beside you.."),i.a.createElement("div",{className:"landing form-block w-form"},i.a.createElement("form",{id:"email-form",onSubmit:this.joinMeeting,name:"email-form","data-name":"Email Form",className:"landing form"},i.a.createElement("input",{type:"text",className:"landing text-field w-input",maxLength:"256",name:"name","data-name":"Name",placeholder:"Meeting ID..",id:"meetingField",defaultValue:"WhisperDefaultMeetingRoom"}),i.a.createElement("input",{type:"text",className:"landing text-field w-input",maxLength:"256",name:"name","data-name":"Name",placeholder:"Your Name..",id:"userField",defaultValue:"John Doe"}),i.a.createElement("input",{type:"submit",value:"Join Meeting","data-wait":"Please wait...",className:"landing submit-button w-button"})),i.a.createElement("div",{className:"landing w-form-done"},i.a.createElement("div",null,"Thank you! Your submission has been received!")),i.a.createElement("div",{className:"landing w-form-fail"},i.a.createElement("div",null,"Oops! Something went wrong while submitting the form."))))}}]),a}(n.Component),f=a(22),b=a(11),h=(a(31),a(42),a(34),a(41),a(20)),E=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"render",value:function(){var e=this.props.message,t=e.uid===window.GLOBAL.meeting.userId;return"recording"===e.type?i.a.createElement("div",{className:"div-block-11 "+(t?"":"received")},i.a.createElement("div",null,i.a.createElement("div",{className:"div-block-10 "+(t?"":"received")},i.a.createElement("figure",null,i.a.createElement("audio",{style:{margin:"10px 5px 5px 10px"},controls:!0,src:e.text}))),i.a.createElement("div",{style:{marginTop:"-10px"}},e.uid," -- ",e.createdAt&&e.createdAt.toDate().toLocaleString()))):i.a.createElement("div",{className:"div-block-11 "+(t?"":"received")},i.a.createElement("div",null,i.a.createElement("div",{className:"div-block-10 "+(t?"":"received")},i.a.createElement("div",{className:"text-block-3"},e.text)),i.a.createElement("div",{style:{marginTop:"-2px"}},e.uid," -- ",e.createdAt&&e.createdAt.toDate().toLocaleString())))}}]),a}(n.Component),k=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).bottomRef=i.a.createRef(),n}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return console.log("MessagesList",this.props.messages),setTimeout((function(){console.log(e.bottomRef),e.bottomRef.current&&e.bottomRef.current.scrollIntoView({behavior:"smooth"})}),100),i.a.createElement("div",{style:{overflow:"scroll",height:"55vh"}},this.props.messages&&this.props.messages.reverse().map((function(e){return i.a.createElement(E,{key:e.id,message:e})})),i.a.createElement("span",{ref:this.bottomRef}))}}]),a}(n.Component),w=a(16),N=a(21),y=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).startRecording=function(){n.setState({record:!0})},n.stopRecording=function(){var e=Object(l.a)(n);e.setState({record:!1}),setTimeout((function(){return e.setState({record:!1})}),100)},n.state={record:!1},console.log(a,Object(l.a)(n)),n.state.record||setTimeout((function(){return n.startRecording()}),1),n}return Object(c.a)(a,[{key:"onData",value:function(e){console.log("chunk of real-time data is: ",e)}},{key:"onStop",value:function(e){console.log("recordedBlob is: ",e,this),this.saveToFirebase(e)}},{key:"saveToFirebase",value:function(e){var t=this,a=this.props.meeting.userId;return t.props.storageRef.child("uploads/"+a+"-"+e.stopTime+".mp3").put(e.blob,{contentType:"audio/mp3"}).then((function(e){e.ref.getDownloadURL().then((function(n){console.log("audioUpload callback",e),t.props.messagesRef.add({text:n,type:"recording",createdAt:b.a.firestore.FieldValue.serverTimestamp(),uid:a})}))}))}},{key:"render",value:function(){return i.a.createElement("div",{style:{width:"100%",height:"100%"}},i.a.createElement(N.ReactMic,{record:this.state.record,className:"sound-wave",mimeType:"audio/webm",onStop:this.onStop.bind(this),autoGainControl:!0,strokeColor:"#9b9b9b",width:"300",backgroundColor:"#000813"}))}}]),a}(i.a.Component),j=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).sendMessage=function(){var e=Object(g.a)(p.a.mark((function e(t){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n.state.inputValue){e.next=2;break}return e.abrupt("return");case 2:return t.preventDefault(),a=n.props.meeting.userId,e.next=6,n.props.messagesRef.add({type:"text",text:n.state.inputValue,createdAt:b.a.firestore.FieldValue.serverTimestamp(),uid:a});case 6:n.state.inputValue="";case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={inputType:"text",inputValue:""},n.audioRecRef=i.a.createRef(),n}return Object(c.a)(a,[{key:"render",value:function(){var e,t=this;return"text"===this.state.inputType?i.a.createElement(i.a.Fragment,null,i.a.createElement("form",{onSubmit:this.sendMessage,className:"div-block-7"},i.a.createElement("input",(e={className:"text-block-2",type:"text",value:this.state.inputValue,onChange:function(e){return t.setState({inputValue:e.target.value})},placeholder:"Type here...","aria-describedby":"button-addon2"},Object(w.a)(e,"className","form-control rounded-0 border-0 py-4 bg-light"),Object(w.a)(e,"style",{background:"transparent",width:"100%",border:"none",color:"gray",height:"min-content"}),e)),i.a.createElement("div",{className:"div-block-8"},i.a.createElement("div",{className:"div-block-9",onClick:this.sendMessage},i.a.createElement("i",{className:"fa fa-send"})),i.a.createElement("div",{className:"div-block-9",onClick:function(){return alert("Not Implemented Yet!")}},i.a.createElement("i",{className:"fa fa-phone"})),i.a.createElement("div",{className:"div-block-9",onClick:function(){t.setState({inputType:"record"})}},i.a.createElement("i",{className:"fa fa-bullseye"}))))):"record"===this.state.inputType?i.a.createElement(i.a.Fragment,null,i.a.createElement("form",{onSubmit:this.sendMessage,className:"div-block-7"},i.a.createElement(y,{ref:this.audioRecRef,meeting:this.props.meeting,storageRef:this.props.storageRef,messagesRef:this.props.messagesRef}),i.a.createElement("div",{className:"div-block-8"},i.a.createElement("div",{className:"div-block-9",onClick:function(){console.log(t.audioRecRef&&t.audioRecRef.current),t.audioRecRef.current.stopRecording(),setTimeout((function(){t.setState({inputType:"text"})}),100)}},i.a.createElement("i",{className:"fa fa-stop"}))))):void 0}}]),a}(n.Component);b.a.initializeApp({apiKey:"AIzaSyCgNBwvWRmiD-XKVVwPlXtfeFgDxrdS1Cc",authDomain:"ecse542-whisper.firebaseapp.com",databaseURL:"https://ecse542-whisper.firebaseio.com",projectId:"ecse542-whisper",storageBucket:"ecse542-whisper.appspot.com",messagingSenderId:"994712361483",appId:"1:994712361483:web:47d47d3f160de1a275450e",measurementId:"G-S42HK278KF"});var O=b.a.firestore();window.firebase=b.a;var x=function(e){var t=O.collection("messages"),a=b.a.storage().ref(),n=t.orderBy("createdAt","desc").limit(25),r=Object(h.a)(n,{idField:"id"}),o=Object(f.a)(r,1)[0];return console.log("messages",o),i.a.createElement("div",{className:"div-block-2"},i.a.createElement("div",null,i.a.createElement("div",{className:"div-block-6"},i.a.createElement("div",{className:"text-block"},"Your Group"),i.a.createElement("div",{className:"text-block less"},"Main Chat"))),i.a.createElement("div",{className:"div-block-5"},i.a.createElement("div",{className:"w-layout-grid green"},i.a.createElement("div",{className:"div-block-3"},i.a.createElement("div",{className:"div-block-4 green"},i.a.createElement("div",{className:"text-block"},"Joseff Padilla"))),i.a.createElement("div",{className:"div-block-3 hover"},i.a.createElement("div",{className:"text-block"},i.a.createElement("strong",null,"Private whisper to"),"Kaiya Bowen")),i.a.createElement("div",{className:"div-block-3 you"},i.a.createElement("div",{className:"div-block-4 green"},i.a.createElement("div",{className:"text-block"},"Jodi Avery (You)"))),i.a.createElement("div",{className:"div-block-3"},i.a.createElement("div",{className:"div-block-4 green"},i.a.createElement("div",{className:"text-block"},"Blake Kemp"))))),i.a.createElement(k,{messages:o}),i.a.createElement(j,{meeting:e.meeting,messagesRef:t,storageRef:a}))},R=window.JitsiMeetExternalAPI||{},T=!1,M=function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){return Object(s.a)(this,a),t.call(this,e)}return Object(c.a)(a,[{key:"render",value:function(){var e=this;return console.log("MainJitsi",this.props),setTimeout((function(){T||(T=!0,window.api=new R("meet.jit.si",{roomName:e.props.meeting.meetingId,parentNode:document.getElementById("MainJitsi"),width:"100%",height:"100%",userInfo:{displayName:e.props.meeting.userId},configOverwrite:{prejoinPageEnabled:!1}}))}),500),i.a.createElement("div",{id:"MainJitsi"})}}]),a}(n.Component),S=(a(39),function(e){Object(m.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(s.a)(this,a),(n=t.call(this,e)).state={page:"join"},n}return Object(c.a)(a,[{key:"goToMeeting",value:function(e){this.setState({meeting:e}),this.setState({page:"meeting"}),console.log("App.goToMeeting",e,this),window.GLOBAL=window.GLOBAL||{},window.GLOBAL.meeting=e}},{key:"render",value:function(){return console.log("App.render",this),this.state?"join"===this.state.page?i.a.createElement(v,{goToMeeting:this.goToMeeting.bind(this)}):i.a.createElement(i.a.Fragment,null,i.a.createElement(x,{meeting:this.state.meeting}),i.a.createElement("div",{className:"div-block"},i.a.createElement(M,{meeting:this.state.meeting}))):i.a.createElement(i.a.Fragment,null)}}]),a}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[23,1,2]]]);
//# sourceMappingURL=main.6de652e4.chunk.js.map